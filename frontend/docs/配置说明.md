# 前端项目配置说明

## package.json 配置详解

### 项目基本信息

```json
{
  "name": "wechat-fortune-draw-frontend",
  "version": "1.0.0",
  "description": "微信小程序新年抽签应用前端",
  "main": "main.js",
  "license": "MIT"
}
```

- **name**: 项目名称，遵循npm包命名规范
- **version**: 项目版本号，采用语义化版本控制
- **description**: 项目描述，使用中文说明项目用途
- **main**: 主入口文件
- **license**: 开源许可证，使用MIT许可证

### 环境要求

```json
{
  "engines": {
    "node": ">=18.0.0",
    "npm": ">=8.0.0"
  }
}
```

- **Node.js版本**: 要求18.0.0或更高版本，确保支持最新的JavaScript特性
- **npm版本**: 要求8.0.0或更高版本，支持现代包管理功能

### 浏览器兼容性

```json
{
  "browserslist": [
    "defaults",
    "not IE 11",
    "maintained node versions"
  ]
}
```

- 使用默认的现代浏览器支持
- 明确排除IE 11支持
- 支持维护中的Node.js版本

## 脚本命令详解

### 开发相关命令

| 命令 | 说明 | 用途 |
|------|------|------|
| `npm run dev` | 默认开发命令 | 启动微信小程序开发模式 |
| `npm run serve` | 服务启动命令 | 同dev命令的别名 |
| `npm run dev:mp-weixin` | 微信小程序开发 | 专门用于微信小程序平台开发 |
| `npm run dev:h5` | H5开发模式 | 用于网页版本的快速调试 |
| `npm run dev:app` | App开发模式 | 用于移动应用开发 |

### 构建相关命令

| 命令 | 说明 | 输出目录 |
|------|------|----------|
| `npm run build` | 默认构建命令 | `dist/build/mp-weixin/` |
| `npm run build:mp-weixin` | 微信小程序构建 | `dist/build/mp-weixin/` |
| `npm run build:h5` | H5版本构建 | `dist/build/h5/` |
| `npm run build:app` | App版本构建 | `dist/build/app/` |

### 代码质量命令

| 命令 | 说明 | 功能 |
|------|------|------|
| `npm run lint` | 代码检查和修复 | 使用ESLint检查并自动修复代码问题 |
| `npm run lint:check` | 仅检查代码 | 检查代码问题但不自动修复 |
| `npm run format` | 代码格式化 | 使用Prettier格式化所有代码文件 |
| `npm run format:check` | 检查格式 | 检查代码格式是否符合规范 |
| `npm run type-check` | 类型检查 | 使用TypeScript检查类型错误 |

### 测试相关命令

| 命令 | 说明 | 功能 |
|------|------|------|
| `npm test` | 运行所有测试 | 执行完整的测试套件 |
| `npm run test:watch` | 监听模式测试 | 文件变化时自动重新运行测试 |
| `npm run test:coverage` | 覆盖率测试 | 生成测试覆盖率报告 |
| `npm run test:ci` | CI环境测试 | 适用于持续集成环境的测试 |
| `npm run test:unit` | 单元测试 | 仅运行单元测试 |
| `npm run test:integration` | 集成测试 | 仅运行集成测试 |

## 依赖包说明

### 核心依赖 (dependencies)

#### uni-app框架相关
```json
{
  "@dcloudio/uni-app": "3.0.0-4020920240930001",
  "@dcloudio/uni-components": "3.0.0-4020920240930001"
}
```
- **uni-app核心**: 跨平台开发框架的核心包
- **uni-components**: uni-app官方组件库

#### 平台适配包
```json
{
  "@dcloudio/uni-mp-weixin": "3.0.0-4020920240930001",
  "@dcloudio/uni-h5": "3.0.0-4020920240930001",
  "@dcloudio/uni-app-plus": "3.0.0-4020920240930001"
}
```
- **uni-mp-weixin**: 微信小程序平台适配
- **uni-h5**: H5网页平台适配
- **uni-app-plus**: App平台适配

#### 前端框架
```json
{
  "vue": "^3.4.21",
  "pinia": "^2.1.7",
  "vue-i18n": "^9.9.1"
}
```
- **Vue 3**: 现代化前端框架，支持Composition API
- **Pinia**: Vue 3官方推荐的状态管理库
- **Vue i18n**: 国际化支持库（预留功能）

### 开发依赖 (devDependencies)

#### TypeScript相关
```json
{
  "typescript": "^5.3.3",
  "@types/node": "^20.11.5",
  "vue-tsc": "^1.8.27"
}
```
- **TypeScript**: 类型安全的JavaScript超集
- **@types/node**: Node.js类型定义
- **vue-tsc**: Vue单文件组件的TypeScript检查器

#### 代码质量工具
```json
{
  "eslint": "^8.56.0",
  "prettier": "^3.2.5",
  "@typescript-eslint/eslint-plugin": "^7.0.1",
  "eslint-plugin-vue": "^9.20.1"
}
```
- **ESLint**: JavaScript/TypeScript代码检查工具
- **Prettier**: 代码格式化工具
- **TypeScript ESLint**: TypeScript专用的ESLint规则
- **Vue ESLint**: Vue.js专用的ESLint规则

#### 测试框架
```json
{
  "jest": "^29.7.0",
  "@vue/test-utils": "^2.4.4",
  "jest-environment-jsdom": "^29.7.0",
  "ts-jest": "^29.1.2"
}
```
- **Jest**: JavaScript测试框架
- **Vue Test Utils**: Vue组件测试工具
- **JSDOM**: 浏览器环境模拟器
- **ts-jest**: Jest的TypeScript支持

#### 构建工具
```json
{
  "vite": "^5.1.3",
  "@dcloudio/vite-plugin-uni": "3.0.0-4020920240930001",
  "sass": "^1.70.0"
}
```
- **Vite**: 现代化构建工具，提供快速的开发体验
- **Vite uni插件**: uni-app的Vite插件
- **Sass**: CSS预处理器

## 配置文件关联

### TypeScript配置 (tsconfig.json)
- 与package.json中的TypeScript版本保持一致
- 配置编译选项和路径映射

### Vite配置 (vite.config.ts)
- 使用package.json中指定的Vite版本
- 配置uni-app插件和构建选项

### Jest配置 (jest.config.js)
- 使用package.json中的Jest版本
- 配置测试环境和覆盖率选项

### ESLint配置 (.eslintrc.js)
- 使用package.json中的ESLint相关包
- 配置代码检查规则

### Prettier配置 (.prettierrc.js)
- 使用package.json中的Prettier版本
- 配置代码格式化规则

## 开发工作流

### 1. 项目初始化
```bash
# 克隆项目
git clone <repository-url>

# 进入前端目录
cd frontend

# 安装依赖
npm install
```

### 2. 开发阶段
```bash
# 启动开发服务器
npm run dev

# 代码检查
npm run lint

# 类型检查
npm run type-check

# 运行测试
npm test
```

### 3. 构建部署
```bash
# 构建生产版本
npm run build

# 检查构建结果
npm run preview
```

### 4. 代码提交前
```bash
# 格式化代码
npm run format

# 检查代码质量
npm run lint:check

# 运行完整测试
npm run test:ci
```

## 版本升级指南

### 依赖包升级
```bash
# 检查过时的包
npm outdated

# 升级所有依赖到最新版本
npm update

# 升级特定包
npm install package-name@latest
```

### 主要版本升级注意事项
- **uni-app**: 升级时需要检查API变更和平台兼容性
- **Vue 3**: 关注Composition API的变化
- **TypeScript**: 注意类型系统的更新
- **Vite**: 检查构建配置的兼容性

## 故障排除

### 常见问题

1. **依赖安装失败**
   ```bash
   # 清理缓存重新安装
   npm cache clean --force
   rm -rf node_modules package-lock.json
   npm install
   ```

2. **TypeScript类型错误**
   ```bash
   # 重新生成类型声明
   npm run type-check
   ```

3. **构建失败**
   ```bash
   # 清理构建缓存
   npm run clean
   npm run build
   ```

4. **测试失败**
   ```bash
   # 更新测试快照
   npm test -- --updateSnapshot
   ```

### 性能优化建议

1. **使用npm ci代替npm install**（在CI环境中）
2. **定期清理node_modules**
3. **使用.npmrc配置加速下载**
4. **合理使用devDependencies和dependencies**

## 总结

这个package.json配置文件为微信小程序新年抽签应用提供了完整的开发环境支持，包括：

- 现代化的技术栈（Vue 3 + TypeScript + Vite）
- 完善的代码质量保障（ESLint + Prettier + Jest）
- 多平台支持（微信小程序、H5、App）
- 丰富的开发工具和脚本命令

通过合理的配置和工作流，确保项目的开发效率和代码质量。